<div>
    <h2>SSH Public Key</h2>

    <p>
        This is the SSH public key stored in this server's <code>&#126;/.ssh/id_rsa.pub</code>
    </p>
    <p>
        This key should be used to grant access for this server to the Git repository which holds the Spring Cloud Configuration files.
    </p>

    <h3>Key</h3>

    <pre>{{vm.data}}</pre>

    <h3>More information when using Docker</h3>

    <p>
        Here are detailed instruction when using the JHipster Registry Docker image, which is available at
        <a href="https://hub.docker.com/r/jhipster/jhipster-registry/" target="_blank">jhipster/jhipster-registry/</a> .
    </p>

    <ul>
        <li>Log in inside the container: <code>docker -it &lt;containerIdOrName&gt; sh</code></li>
        <li>Generate an SSH key: <code>ssh-keygen</code></li>
        <li>Copy the public key in <code>/root/.ssh/id_rsa.pub</code> to the remote Git repository you want to access
            (in Github, go to your settings/SSH keys)</li>
        <li>Test inside your container that the SSH connection is working:
            <ul>
                <li>Log in to your Git repository: <code>ssh -T git@github.com</code></li>
                <li>When asked to to add the Git repository host to the list of known hosts, reply <b>yes</b></li>
            </ul>
        </li>
        <li>Restart the registry without removing the container, it should be able to read a Git repo secured by SSH</li>
    </ul>

    <p>
    In order not to lose our setup every time you recreate or update the container, you can mount the
    <code>/root/.ssh/</code> folder to a Docker volume.
    </p>

    <p>For example using Docker Compose:</p>
    <div hljs hljs-language="yaml">
    version: '2'
    services:
      jhipster-registry:
        container_name: jhipster-registry
        image: jhipster/jhipster-registry
    volumes:
      - ./ssh/:/root/.ssh/
    environment:
      - SPRING_PROFILES_ACTIVE=prod,git
      - GIT_URI=ssh:git@github.com:jhipster/test-registry.git
    ports:
      - 8761:8761
  </div>
</div>
